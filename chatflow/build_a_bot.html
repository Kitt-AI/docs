

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>ChatFlow Build A Bot Tutorial &mdash; ChatFlow 0.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
  
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" type="text/css" />
  

  
    <link rel="top" title="ChatFlow 0.1 documentation" href="index.html"/>
        <link rel="next" title="Dialogue Nodes" href="dialogue_nodes.html"/>
        <link rel="prev" title="ChatFlow Quick Start" href="quickstart.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            
              <a href="http://chatflow.kitt.ai" target="_blank" class="icon icon-home"> ChatFlow
            
          

          
            
            <img src="_static/chatflow-logo.png" class="logo" />
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="index.html">Welcome to ChatFlow</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">ChatFlow Quick Start</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">ChatFlow Build A Bot Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="#build-a-bot-walkthrough-video">Build A Bot Walkthrough Video</a></li>
<li class="toctree-l2"><a class="reference internal" href="#creating-an-app-from-scratch">1. Creating an App from Scratch</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-conversational-router">2. The Conversational Router</a></li>
<li class="toctree-l2"><a class="reference internal" href="#enter-and-state-nodes">Enter and State Nodes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#enter-node">Enter Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="#state-node">State Node</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#adding-input-and-output">3. Adding input and output</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#no-case">No Case</a></li>
<li class="toctree-l3"><a class="reference internal" href="#yes-case">Yes Case</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unable-to-process-case">Unable To Process Case</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#nlu-dealing-with-natural-language-input">4. NLU &amp; Dealing with Natural Language Input</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#add-an-nlu-node">Add an NLU Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="#create-and-nlu-app">Create and NLU App</a></li>
<li class="toctree-l3"><a class="reference internal" href="#deploy-the-nlu-app">Deploy the NLU App</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configure-the-nlu-node">Configure the NLU Node</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#reconfiguring-the-enter-nodes">5. Reconfiguring The Enter Nodes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#export-and-import">Export and Import</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dialogue_nodes.html">Dialogue Nodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="extended_example.html">Extended Example: A conversational Yelp bot</a></li>
<li class="toctree-l1"><a class="reference internal" href="telegram.html">Telegram Bot Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="facebook.html">Facebook Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="slack.html">Slack Bot Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="twilio.html">Twilio Bot Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="kik.html">Kik Bot Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="alexa.html">Alexa Skill Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="alexa_advanced.html">Advanced Alexa Skill Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="alexa_nlu.html">Advanced Alexa Skill NLU Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="oauth2.html">OAuth2/Uber Tutorials</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">ChatFlow</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          













<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>ChatFlow Build A Bot Tutorial</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          <a href="https://groups.google.com/a/kitt.ai/forum/#!forum/chat" class="fa fa-comments" style="color:#55507c" target="_blank"> Forum</a>
        
        
            
            <a href="_sources/build_a_bot.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="chatflow-build-a-bot-tutorial">
<span id="build-a-bot"></span><h1><a class="toc-backref" href="#id3">ChatFlow Build A Bot Tutorial</a><a class="headerlink" href="#chatflow-build-a-bot-tutorial" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#chatflow-build-a-bot-tutorial" id="id3">ChatFlow Build A Bot Tutorial</a><ul>
<li><a class="reference internal" href="#introduction" id="id4">Introduction</a></li>
<li><a class="reference internal" href="#build-a-bot-walkthrough-video" id="id5">Build A Bot Walkthrough Video</a></li>
<li><a class="reference internal" href="#creating-an-app-from-scratch" id="id6">1. Creating an App from Scratch</a></li>
<li><a class="reference internal" href="#the-conversational-router" id="id7">2. The Conversational Router</a></li>
<li><a class="reference internal" href="#enter-and-state-nodes" id="id8">Enter and State Nodes</a><ul>
<li><a class="reference internal" href="#enter-node" id="id9">Enter Node</a></li>
<li><a class="reference internal" href="#state-node" id="id10">State Node</a></li>
</ul>
</li>
<li><a class="reference internal" href="#adding-input-and-output" id="id11">3. Adding input and output</a><ul>
<li><a class="reference internal" href="#no-case" id="id12">No Case</a></li>
<li><a class="reference internal" href="#yes-case" id="id13">Yes Case</a></li>
<li><a class="reference internal" href="#unable-to-process-case" id="id14">Unable To Process Case</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nlu-dealing-with-natural-language-input" id="id15">4. NLU &amp; Dealing with Natural Language Input</a><ul>
<li><a class="reference internal" href="#add-an-nlu-node" id="id16">Add an NLU Node</a></li>
<li><a class="reference internal" href="#create-and-nlu-app" id="id17">Create and NLU App</a></li>
<li><a class="reference internal" href="#deploy-the-nlu-app" id="id18">Deploy the NLU App</a></li>
<li><a class="reference internal" href="#configure-the-nlu-node" id="id19">Configure the NLU Node</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reconfiguring-the-enter-nodes" id="id20">5. Reconfiguring The Enter Nodes</a></li>
<li><a class="reference internal" href="#export-and-import" id="id21">Export and Import</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id4">Introduction</a><a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>In this <a class="reference external" href="https://chatflow.kitt.ai/">ChatFlow</a> tutorial, we will walkthrough the process of building a bot
from start to finish. In addition, we will introduce <a class="reference external" href="https://nlu.kitt.ai/">NLU</a> - ChatFlow&#8217;s
<strong>Natural Language Understanding</strong> companion program.</p>
<dl class="docutils">
<dt>By the end of this tutorial, you will be able to:</dt>
<dd><ul class="first last simple">
<li>create a new project from scratch</li>
<li>configure Enter and State nodes</li>
<li>create an <a class="reference external" href="https://nlu.kitt.ai/">NLU</a> application.</li>
<li>configure the NLU node in <a class="reference external" href="https://chatflow.kitt.ai/">ChatFlow</a></li>
<li>export and Import Projects</li>
</ul>
</dd>
</dl>
<p>The final bot should go like this:</p>
<video width="640"  controls>
  <source src="_static/img/buildabot/BuildABotSample.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>
<br> <br> <br><p>A video tutorial is also appended in <a class="reference internal" href="#walkthrough-video"><span class="std std-ref">Build A Bot Walkthrough Video</span></a>.</p>
</div>
<div class="section" id="build-a-bot-walkthrough-video">
<span id="walkthrough-video"></span><h2><a class="toc-backref" href="#id5">Build A Bot Walkthrough Video</a><a class="headerlink" href="#build-a-bot-walkthrough-video" title="Permalink to this headline">¶</a></h2>
<p>In addition, here is a video walking you through the entire creation process:</p>
<iframe width="640" height="360" src="https://www.youtube.com/embed/t-SHOOCfDrI"
   frameborder="0" allowfullscreen></iframe>
<br><br><br></div>
<div class="section" id="creating-an-app-from-scratch">
<h2><a class="toc-backref" href="#id6">1. Creating an App from Scratch</a><a class="headerlink" href="#creating-an-app-from-scratch" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s create a simple flow that does a little more than just say hello. Our new
bot will simply ask users for a free lunch. In addition, it will keep count of
how many times it had to ask before getting a free lunch.</p>
<ol class="arabic simple">
<li>Click on &#8220;Create new app&#8221; to start creating a new app.</li>
</ol>
<img alt="_images/CreateNewApp.png" class="align-center" src="_images/CreateNewApp.png" />
<ol class="arabic simple" start="2">
<li>Under the &#8220;Start with a clean project&#8221; section, enter your project name and
click &#8220;Create&#8221;.</li>
</ol>
<img alt="_images/StartFromScratch.png" class="align-center" src="_images/StartFromScratch.png" />
<ol class="arabic simple" start="3">
<li>Your bot will appear in your <strong>App List</strong>. Click on the name to enter the
editor.</li>
</ol>
<img alt="_images/AppList.png" class="align-center" src="_images/AppList.png" />
<ol class="arabic simple" start="4">
<li>Once the page loads, you will have an empty canvas, as shown below.</li>
</ol>
<img alt="_images/BlankCanvas.png" class="align-center" src="_images/BlankCanvas.png" />
<ol class="arabic simple" start="5">
<li>Drag in the Chat In and Chat Out Nodes.</li>
</ol>
<img alt="_images/chatin-chatout.png" class="align-center" src="_images/chatin-chatout.png" />
</div>
<div class="section" id="the-conversational-router">
<h2><a class="toc-backref" href="#id7">2. The Conversational Router</a><a class="headerlink" href="#the-conversational-router" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Drag a <strong>router</strong> node onto the empty canvas. Connect the Chat In, Router, and
Chat Out nodes like the image below:</li>
</ol>
<img alt="_images/router-node.png" class="align-center" src="_images/router-node.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The router is responsible for directing messages within our flow
producing the conversational agent&#8217;s output. In order to function, a project
must have a router!</p>
</div>
<ol class="arabic simple" start="2">
<li>Double-click on the router node to name the router node.</li>
</ol>
<img alt="_images/router-pop-up.png" class="align-center" src="_images/router-pop-up.png" />
</div>
<div class="section" id="enter-and-state-nodes">
<h2><a class="toc-backref" href="#id8">Enter and State Nodes</a><a class="headerlink" href="#enter-and-state-nodes" title="Permalink to this headline">¶</a></h2>
<p>Besides the router node, we are going to need two other nodes from the
<em>dialogue</em> section of the Node Library - the <strong>enter</strong> and <strong>state</strong> nodes.</p>
<p>The <strong>state</strong> nodes are used to define what the bot will say. The <strong>enter</strong>
nodes are used to specify <em>entrance conditions</em> to specify when specific
<strong>state</strong> nodes will be used.</p>
<div class="section" id="enter-node">
<h3><a class="toc-backref" href="#id9">Enter Node</a><a class="headerlink" href="#enter-node" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Add an <strong>enter</strong> node to the canvas. Each enter node contains a set of
<em>entrance conditions</em> that specify when that specific enter node is chosen by
the router.</li>
</ol>
<img alt="_images/enternode-1.png" class="align-center" src="_images/enternode-1.png" />
<ol class="arabic simple" start="2">
<li>Doubleclick on the enter node to edit.</li>
</ol>
<img alt="_images/enternode-popup.png" class="align-center" src="_images/enternode-popup.png" />
<ol class="arabic simple" start="3">
<li>In this pop-up, name the node. Let&#8217;s call this enter node <em>Initial state</em>.</li>
<li>Below the name field is the selection conditions section. Remove the
conditions by clicking on the &#8220;&#8221;X&#8221;&#8221; to the right of the condition.</li>
</ol>
<img alt="_images/highlightedx.png" class="align-center" src="_images/highlightedx.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">One condition is partially added by default to get you started.</p>
</div>
<ol class="arabic simple" start="5">
<li>Check the box towards the bottom of the pop-up that says <em>Initial state</em>.
This will tell the router that this enter node is the first enter node of
the flow. You can then attach a <a class="reference internal" href="#state-node"><span class="std std-ref">State Node</span></a> to it for initializing
variables.</li>
</ol>
<img alt="_images/initial-state.png" class="align-center" src="_images/initial-state.png" />
</div>
<div class="section" id="state-node">
<span id="id1"></span><h3><a class="toc-backref" href="#id10">State Node</a><a class="headerlink" href="#state-node" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Drag a state node onto canvas to the right of the enter node.</li>
<li>Connect the enter node and the state node together. Click on the grey dot on the
right of the enter node. Drag the resulting wire to the left grey dot of the
state node.</li>
</ol>
<img alt="_images/Intialstate-statenode.png" class="align-center" src="_images/Intialstate-statenode.png" />
<ol class="arabic" start="3">
<li><p class="first">Doubleclick on the new state node. Name it <em>Initialize state</em>.</p>
</li>
<li><p class="first">Below the name field, you will find a code editor. In the code editor, create
a single variable called <code class="docutils literal"><span class="pre">count</span></code> that will keep track of how many times our
bot has asked the user for lunch. The code inside this state node will be:</p>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="n">msg</span><span class="o">.</span><span class="n">kitt</span><span class="o">.</span><span class="n">count</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">return</span> <span class="n">msg</span><span class="p">;</span>
</pre></div>
</div>
</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">User variables are passed from node to node in the variable
<code class="docutils literal"><span class="pre">msg</span></code>. In addition, special propery <code class="docutils literal"><span class="pre">msg.kitt</span></code> will be persisted
over sessions so you can track your context over different dialogue turns.
Our variable in this case is <code class="docutils literal"><span class="pre">msg.kitt.count</span></code>.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The code associated with the state node should end with <code class="docutils literal"><span class="pre">return</span> <span class="pre">msg;</span></code>.
Otherwise no message will be outputted, thus halting the conversation.</p>
</div>
<ol class="arabic simple" start="5">
<li>Select the &#8220;Request User Input After This Node&#8221; option. The bot will wait for
the users response before proceeding.</li>
<li>In the <em>Output text</em> field, input <em>&#8220;Hello! Will you please buy me lunch?&#8221;</em>
Output text is outputted whenever the state node is activated. The figure
below shows what your state node should look like.</li>
</ol>
<img alt="_images/initialize-state.png" class="align-center" src="_images/initialize-state.png" />
</div>
</div>
<div class="section" id="adding-input-and-output">
<h2><a class="toc-backref" href="#id11">3. Adding input and output</a><a class="headerlink" href="#adding-input-and-output" title="Permalink to this headline">¶</a></h2>
<ol class="arabic simple">
<li>Deploy the bot.</li>
</ol>
<img alt="_images/deploy.png" class="align-center" src="_images/deploy.png" />
<ol class="arabic simple" start="2">
<li>Open the chat tab. Enter <em>hello</em> into the input field on the bottom of the
screen. You should see a system output message from the state node <em>Initialize state</em>.</li>
</ol>
<img alt="_images/chat-bubble.png" class="align-center" src="_images/chat-bubble.png" />
<div class="section" id="no-case">
<h3><a class="toc-backref" href="#id12">No Case</a><a class="headerlink" href="#no-case" title="Permalink to this headline">¶</a></h3>
<p>Further input to this agent does nothing, since the system has nothing
else to say. Let&#8217;s now give the agent the ability to handle <em>yes</em> and
<em>no</em> answers from the user.</p>
<ol class="arabic simple">
<li>Add an enter node and a state node and connect them as before.</li>
<li>Edit the enter node in the following way. Name it <em>&#8220;U: no&#8221;</em>. Set its
condition to <code class="docutils literal"><span class="pre">Property</span> <span class="pre">msg.payload</span> <span class="pre">==</span> <span class="pre">no</span></code>, which simply checks if the
user input to the router coming from the <em>Chat In</em> node is &#8220;no&#8221;.</li>
</ol>
<img alt="_images/u-no.png" class="align-center" src="_images/u-no.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">By convention, the main output of nodes is placed into <code class="docutils literal"><span class="pre">payload</span></code>, so
we can access the user input coming from <em>Chat In</em> in the value of <code class="docutils literal"><span class="pre">msg.payload</span></code>.</p>
</div>
<ol class="arabic simple" start="3">
<li>Edit the new state node. Name it <em>ask again</em> and add the following code into
its body:</li>
</ol>
<div class="code javascript highlight-default"><div class="highlight"><pre><span></span><span class="n">msg</span><span class="o">.</span><span class="n">kitt</span><span class="o">.</span><span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
<span class="k">return</span> <span class="n">msg</span><span class="p">;</span>
</pre></div>
</div>
<ol class="arabic simple" start="4">
<li>In the <em>Output text</em> field, enter <em>I must insist. Will you reconsider?</em> Your
state node should look like the one shown below:</li>
</ol>
<img alt="_images/ask-again.png" class="align-center" src="_images/ask-again.png" />
</div>
<div class="section" id="yes-case">
<h3><a class="toc-backref" href="#id13">Yes Case</a><a class="headerlink" href="#yes-case" title="Permalink to this headline">¶</a></h3>
<p>Now that the system understands <em>no</em>, let&#8217;s add another enter node and
another state node to handle <em>yes</em>.</p>
<ol class="arabic simple">
<li>Add another enter and state nodes and connect them as before.</li>
<li>Name the enter node <em>U:yes</em> and add the entrance condition
<code class="docutils literal"><span class="pre">Property</span> <span class="pre">msg.payload</span> <span class="pre">==</span> <span class="pre">yes</span></code>.</li>
<li>Name the new state node <em>thank user</em>, and leave the code in this node as
simply <code class="docutils literal"><span class="pre">return</span> <span class="pre">msg;</span></code> since we don&#8217;t need the system to do anything
else when it reaches this node.</li>
<li>In the <em>Output text</em> field, enter <em>Thank you! Number of times I asked: {{kitt.count}}</em>.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">While in the code editor we must use the full name of the variable
within the message <code class="docutils literal"><span class="pre">msg.kitt.count</span></code>, in the <em>Output text</em> field, we can
access the value of user variables without the <code class="docutils literal"><span class="pre">msg.kitt</span></code> prefix.</p>
</div>
<ol class="arabic simple" start="5">
<li>Check the box that says <em>Dialogue ends here</em> to tell the system that the
conversation is over once we reach this state.</li>
</ol>
<img alt="_images/thank-user.png" class="align-center" src="_images/thank-user.png" />
<p>The figure below shows the  entire conversational network:</p>
<img alt="_images/complete-flow-1.png" class="align-center" src="_images/complete-flow-1.png" />
<ol class="arabic simple" start="6">
<li>Click Deploy and head to the chat tab. You should now be able to have a
simple conversation with the agent as shown below.</li>
</ol>
<img alt="_images/chat-bubble-1.png" class="align-center" src="_images/chat-bubble-1.png" />
</div>
<div class="section" id="unable-to-process-case">
<h3><a class="toc-backref" href="#id14">Unable To Process Case</a><a class="headerlink" href="#unable-to-process-case" title="Permalink to this headline">¶</a></h3>
<p>The system only understands <em>yes</em> and <em>no</em>, because we only included
case-sensitive tests for <em>yes</em> and <em>no</em> user input. If we say anything else,
the agent will not response. We can easily create an enter node to handle all
other input strings.</p>
<ol class="arabic simple">
<li>Add an enter node and a state node to the canvas, and connect them.</li>
<li>Edit the enter node so that its name is &#8220;U: default&#8221; and the single entrance
condition is <code class="docutils literal"><span class="pre">Property</span> <span class="pre">msg.payload</span> <span class="pre">is</span> <span class="pre">not</span> <span class="pre">null</span></code>. In addition, add the
conditions <code class="docutils literal"><span class="pre">Property</span> <span class="pre">msg.payload</span> <span class="pre">!=</span> <span class="pre">yes</span></code> and <code class="docutils literal"><span class="pre">Property</span> <span class="pre">msg.payload</span> <span class="pre">!=</span> <span class="pre">no</span></code></li>
</ol>
<img alt="_images/u-default.png" class="align-center" src="_images/u-default.png" />
<ol class="arabic simple" start="3">
<li>In the new state node, change the name to <em>not understanding</em>, leave the code
as <code class="docutils literal"><span class="pre">return</span> <span class="pre">msg;</span></code> and add the following text to the <em>Output field</em>:
<em>Sorry, I didn&#8217;t understand what you said. I only understand &#8220;yes&#8221; and &#8220;no&#8221;.</em></li>
</ol>
<img alt="_images/not-understanding.png" class="align-center" src="_images/not-understanding.png" />
<p>Now, your agent will always have something to say, whether it understands the
user or not. Your network and your new enter node should look like the figure
below.</p>
<img alt="_images/complete-flow-2.png" class="align-center" src="_images/complete-flow-2.png" />
<p>We can now have interactions like the following using our simple
conversational agent.</p>
<img alt="_images/chat-bubble-2.png" class="align-center" src="_images/chat-bubble-2.png" />
</div>
</div>
<div class="section" id="nlu-dealing-with-natural-language-input">
<h2><a class="toc-backref" href="#id15">4. NLU &amp; Dealing with Natural Language Input</a><a class="headerlink" href="#nlu-dealing-with-natural-language-input" title="Permalink to this headline">¶</a></h2>
<p>We have built a simple conversational engine that illustrates the basic
authoring process in ChatFlow. However, we have yet to address how our agent
should understand real <em>natural language</em> utterances as input. To deal with
input in the form of natural language utterances without restrictions, we use a
<strong>Natural Language Understanding (NLU)</strong> node. The NLU node will map that
utterance into a finite set of intents and entities, which we can then use in
our enter nodes as the basis for our entrance conditions.</p>
<div class="section" id="add-an-nlu-node">
<h3><a class="toc-backref" href="#id16">Add an NLU Node</a><a class="headerlink" href="#add-an-nlu-node" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple">
<li>Insert the NLU node between our <em>Chat In</em> node and out <em>Router</em> node.</li>
</ol>
<img alt="_images/flow-with-NLU.png" class="align-center" src="_images/flow-with-NLU.png" />
</div>
<div class="section" id="create-and-nlu-app">
<h3><a class="toc-backref" href="#id17">Create and NLU App</a><a class="headerlink" href="#create-and-nlu-app" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple" start="2">
<li>Go to <a class="reference external" href="https://nlu.kitt.ai/">NLU</a>, ChatFlow&#8217;s companion app. Create a new NLU app. Name the application.</li>
<li>In the app, click on &#8220;Set Up Intents&#8221; to expand the &#8220;Set Up Intents&#8221; drop down.</li>
</ol>
<img alt="_images/setup-intents.png" class="align-center" src="_images/setup-intents.png" />
<ol class="arabic simple" start="4">
<li>Click on add intent.</li>
<li>Name the new intent <code class="docutils literal"><span class="pre">positive_response</span></code> and click create.</li>
</ol>
<img alt="_images/positive_response.png" class="align-center" src="_images/positive_response.png" />
<ol class="arabic simple" start="6">
<li>Under Example of Use, add the following natural language input strings. Feel
free to include more:<ul>
<li>Yes</li>
<li>yes</li>
<li>sure</li>
<li>of course</li>
<li>you bet!</li>
<li>it would be my honor</li>
</ul>
</li>
<li>When finished, click on the red &#8220;X&#8221; on the top right to exit the window.</li>
</ol>
<img alt="_images/positive_response.png" class="align-center" src="_images/positive_response.png" />
<ol class="arabic" start="8">
<li><p class="first">Click on add intent. Name the new intent <code class="docutils literal"><span class="pre">negative_response</span></code> and click create.
Under Example of Use, add the following natural language input strings. Feel
free to include more:</p>
<blockquote>
<div><ul class="simple">
<li>Nah</li>
<li>no</li>
<li>No way jose!</li>
<li>Never</li>
<li>I shall not</li>
<li>We&nbsp;are not amused</li>
</ul>
</div></blockquote>
</li>
</ol>
<img alt="_images/negative-response.png" class="align-center" src="_images/negative-response.png" />
<ol class="arabic simple" start="9">
<li>Once finished adding the <code class="docutils literal"><span class="pre">positive_response</span></code> and <code class="docutils literal"><span class="pre">negative_response</span></code> intents,
click &#8220;TRAIN APPLICATION&#8221;, and then &#8220;DEPLOY&#8221;.</li>
</ol>
<img alt="_images/deploy-nlu.png" class="align-center" src="_images/deploy-nlu.png" />
<ol class="arabic simple" start="10">
<li>Test you model in the &#8220;Train the model&#8221; Section. Input a sentence and click
analyze.</li>
</ol>
<img alt="_images/train-the-model.png" class="align-center" src="_images/train-the-model.png" />
<ol class="arabic simple" start="11">
<li>Once it has completed, check the result. You can correct it by on the blue
button and selecting the correct response. When finished, click submit.</li>
</ol>
<img alt="_images/submit-response.png" class="align-center" src="_images/submit-response.png" />
</div>
<div class="section" id="deploy-the-nlu-app">
<h3><a class="toc-backref" href="#id18">Deploy the NLU App</a><a class="headerlink" href="#deploy-the-nlu-app" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Before the final deployment, please click &#8220;TRAIN APPLICATION&#8221; to fully
optimize the machine learner. Then you can issue RESTful API calls to your app.</p>
</div>
<ol class="arabic simple" start="12">
<li>Click on &#8220;Show All Apps&#8221; in the upper lefthand corner to go back to the NLU
app list.</li>
<li>In you newly created apps bubble, click on Deployment Information.</li>
</ol>
<img alt="_images/deployment-information.png" class="align-center" src="_images/deployment-information.png" />
<ol class="arabic simple" start="14">
<li>Copy the Deployment Url onto your clipboard.</li>
</ol>
<img alt="_images/deployment-url-expanded.png" class="align-center" src="_images/deployment-url-expanded.png" />
</div>
<div class="section" id="configure-the-nlu-node">
<h3><a class="toc-backref" href="#id19">Configure the NLU Node</a><a class="headerlink" href="#configure-the-nlu-node" title="Permalink to this headline">¶</a></h3>
<ol class="arabic simple" start="15">
<li>Edit the NLU Node. In the URL field paste the Deployment URL.</li>
</ol>
<img alt="_images/flow-with-NLU.png" class="align-center" src="_images/flow-with-NLU.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The NLU node with store all information in <cite>msg.NLU</cite>, for instance, <code class="docutils literal"><span class="pre">msg.NLU.intent</span></code>,
<code class="docutils literal"><span class="pre">msg.NLU.entities</span></code>, and <code class="docutils literal"><span class="pre">msg.NLU.sentence</span></code>.</p>
</div>
<ol class="arabic simple" start="16">
<li>Add <code class="docutils literal"><span class="pre">payload</span></code> to the end of the URL. The final URL will look like this:</li>
</ol>
<p><a class="reference external" href="http://api-nlu.kitt.ai/v1/api/900584f4-7360-479c?token=xxx">http://api-nlu.kitt.ai/v1/api/900584f4-7360-479c?token=xxx</a>?q={{{payload}}}</p>
<img alt="_images/NLU-node-payload.png" class="align-center" src="_images/NLU-node-payload.png" />
</div>
</div>
<div class="section" id="reconfiguring-the-enter-nodes">
<h2><a class="toc-backref" href="#id20">5. Reconfiguring The Enter Nodes</a><a class="headerlink" href="#reconfiguring-the-enter-nodes" title="Permalink to this headline">¶</a></h2>
<p>We now have NLU configured for our bot. However, we are current not using this
information within our bot. In order to do so, we must reconfigure the <em>U: Yes</em>
and <em>U: No</em> Enter nodes.</p>
<ol class="arabic simple">
<li>Edit the <em>U: Yes</em> node. Under the entrance conditions section, remove the
<code class="docutils literal"><span class="pre">Property</span> <span class="pre">msg.payload</span> <span class="pre">==</span> <span class="pre">yes</span></code> condition.</li>
<li>Add a new condition, <code class="docutils literal"><span class="pre">Property</span> <span class="pre">msg.NLU.intent</span> <span class="pre">==</span> <span class="pre">positive_response</span></code>.</li>
</ol>
<img alt="_images/u-yes-2.png" class="align-center" src="_images/u-yes-2.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The NLU runs a query to the NLU app inputting in the payload input from
the <em>Chat In</em> node. It then maps it to an intent storing the intent
information in <code class="docutils literal"><span class="pre">msg.NLU.intent</span></code>.</p>
</div>
<ol class="arabic simple" start="3">
<li>Edit the <em>U: No</em> node. Under the entrance conditions section, remove the
<code class="docutils literal"><span class="pre">Property</span> <span class="pre">msg.payload</span> <span class="pre">==</span> <span class="pre">no</span></code> condition. Add a new condition,
<code class="docutils literal"><span class="pre">Property</span> <span class="pre">msg.NLU.intent</span> <span class="pre">==</span> <span class="pre">negative_response</span></code>.</li>
</ol>
<img alt="_images/u-no-2.png" class="align-center" src="_images/u-no-2.png" />
<ol class="arabic simple" start="4">
<li>When finished, click Deploy.</li>
</ol>
<p>Go ahead and test you bot! The interactions should go a little like this:</p>
<video width="640"  controls>
  <source src="_static/img/buildabot/BuildABotSample.mp4" type="video/mp4">
  Your browser does not support the video tag.
</video>
<br> <br> <br></div>
<div class="section" id="export-and-import">
<h2><a class="toc-backref" href="#id21">Export and Import</a><a class="headerlink" href="#export-and-import" title="Permalink to this headline">¶</a></h2>
<p>In addition, you are able to <em>export</em> and <em>import</em> projects using the <strong>Export</strong>
and <strong>Import JSON</strong> feature.</p>
<p>To export, simply click on Export in the ChatFlow Editor and selected whether you
want the project to be exported with or without credentials. A JSON file containing
the flow information will be exported.</p>
<img alt="_images/export.png" class="align-center" src="_images/export.png" />
<p>To import, simply click on <strong>Import JSON</strong> on the ChatFlow home page and select
the JSON file you wish to import.</p>
<img alt="_images/import.png" class="align-center" src="_images/import.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Both ChatFlow and NLU have export and import features. However, ChatFlow
apps cannot be imported in NLU and NLU apps cannot be imported into ChatFlow.</p>
</div>
<p>Feel free to play with the bots template. You can either:</p>
<ul class="simple">
<li>Download the <a class="reference download internal" href="_downloads/TheFreeLunchBot.json" download=""><code class="xref download docutils literal"><span class="pre">ChatFlow</span> <span class="pre">json</span></code></a> of our
application and import the project using the Import JSON feature on the
<a class="reference external" href="https://chatflow.kitt.ai/apps">applications</a> page.</li>
<li>Use the &#8220;Free Lunch&#8221; sample application when clicking &#8220;CREATE NEW APP&#8221; on the
<a class="reference external" href="https://chatflow.kitt.ai/apps">applications</a> page.</li>
</ul>
<p>In addition, download the <a class="reference download internal" href="_downloads/TheFreeLunchBot-nlu.json" download=""><code class="xref download docutils literal"><span class="pre">NLU</span> <span class="pre">json</span></code></a>
Use the NLU&#8217;s import JSON feature to import it as <a class="reference external" href="https://nlu.kitt.ai">an NLU application</a>
and configure it to your ChatFlow App.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dialogue_nodes.html" class="btn btn-neutral float-right" title="Dialogue Nodes" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="quickstart.html" class="btn btn-neutral" title="ChatFlow Quick Start" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p  style="color:#999;">
        &copy; Copyright 2016, KITT.AI.
      Last updated on Sep 06, 2016.

    </p>
  </div> 

  <div>

    <p>
      Made with <i class="fa fa-heart" style="color:red;"></i> in the city of
      <i class="fa fa-coffee" style="color:#6F4E37;"></i>
      <i class="fa fa-umbrella" style="color:#007FFF;"></i>
      <i class="fa fa-plane" style="color:#0F52BA;"></i>
      <i class="fa fa-diamond" style="color:#50C878;"></i>
    </p>
  </div>

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/js/anchor.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>